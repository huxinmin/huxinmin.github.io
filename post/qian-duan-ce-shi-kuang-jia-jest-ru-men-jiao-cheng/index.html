<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>èƒ¡æ–°æ•çš„ä¸ªäººåšå®¢</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="description" content="èƒ¡æ–°æ•çš„ä¸ªäººåšå®¢"/>
<meta name="keywords" content="èƒ¡æ–°æ•çš„ä¸ªäººåšå®¢"/>

<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
<link rel="shortcut icon" href="https://huxinmin.github.io/favicon.ico">

<link rel="stylesheet" href="https://huxinmin.github.io/styles/main.css">

<!-- Modernizr JS -->
<script src="https://huxinmin.github.io/media/scripts/modernizr-2.6.2.min.js"></script>
<!-- FOR IE9 below -->
<!--[if lt IE 9]>
<scripts src="https://huxinmin.github.io/media/scripts/respond.min.js"></scripts>
<![endif]-->

<!-- Comment -->



<!-- katex -->
<!--<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet">-->

<link href="https://cdn.bootcss.com/font-awesome/5.11.2/css/all.min.css" rel="stylesheet">



</head>
<body>
    <div id="fh5co-offcanvas">
    <a href="#!" class="fh5co-close-offcanvas js-fh5co-close-offcanvas">
        <span><i class="icon-cross3"></i> <span>Close</span></span>
    </a>
    <div class="fh5co-bio">
        <figure>
            <img src="https://huxinmin.github.io/images/avatar.png" alt="èƒ¡æ–°æ•çš„ä¸ªäººåšå®¢"
                 class="img-responsive">
        </figure>
        <a href="https://huxinmin.github.io/post/about/"><h3 class="heading">ABOUT ME</h3></a>
        <h2>èƒ¡æ–°æ•çš„ä¸ªäººåšå®¢</h2>
        <p>èƒ¡æ–°æ•çš„ä¸ªäººåšå®¢</p>
        <ul class="fh5co-social">
            
                <li>
                    
                        <a href="https://github.com/huxinmin" target="_blank">
                            <i class="fab fa-github"></i>
                        </a>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                        <a href="https://www.zhihu.com/people/hu-xin-min-99" target="_blank">
                            <i class="fab fa-zhihu"></i>
                        </a>
                    
                </li>
            
                <li>
                    
                </li>
            
        </ul>
    </div>

    <div class="fh5co-menu">

        <!-- æ ‡ç­¾ -->
        <div class="fh5co-box">
            <a href="https://huxinmin.github.io/tags/"><h3 class="heading">ğŸ‘‰æ ‡ç­¾</h3></a>
            <ul>
                
                    <li><a href="https://huxinmin.github.io/tag/mSeB0wbbH/">linux</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/0CEgc5Nuc/">react</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/AzH6zVqFK/">js</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/UJq-iLfq6/">restful</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/r0zynGCMV/">http</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/GNbObqsVG/">json</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/dZU9srOJ4/">moment.js</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/wsD4ABEPz/">æ•°æ®åº“</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/tq8jF2xcA/">mongoose</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/VL5yScL71/">mongodb</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/XRK7arMJO/">nodejs</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/DJMLUSVfi/">html5</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/oHlYLx_Tl/">websocket</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/8-tAS0eFO/">nginx</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/X3jlBk5nJ/">css</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/H8XsrzQ7e/">css3</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/J27JVlP2F/">æ–‡ä»¶ä¸Šä¼ </a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/X3Z7s8kF_/">jquery</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/CrwH886ky/">ajax</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/s0bxFP3uF/">express</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/38jtWMHZL/">as</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/ZSDYSDwY2/">å…¶ä»–</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/GhuJji1q_/">æµ‹è¯•</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/4OX23_HC0/">jest</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/dlMKptzLv/">ç¼–è¾‘å™¨</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/JavlGTiRY/">editorconfig</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/hK_EE8fK-/">html</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/8ARTmIQjv/">karma</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/Efegfi1Q0/">jasmine</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/tvb1JT8Vl/">mocha</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/9HFOidQXy/">chai</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/siBe4eLq2/">shoudjs</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/82-zkoYE7/">phantomjs</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/Yn33g0TTY/">protracor</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/JEoE22ARw/">scp</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/ZobAApfEI/">æ—¶é—´</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/p-1jKuK3s/">shell</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/o2F0RWP7Z/">expect</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/oZPL-E1ZP/">android</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/J3VGgpXs3/">cordova</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/hMVcUsgPS/">ssh</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/R2oW4iPeR/">travis</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/3v5vwBmB7/">æŒç»­é›†æˆ</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/wal-ORU6g/">debug</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/nDFAAzmpuR/">è°ƒè¯•</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/ev9_gzvje/">eslint</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/ntzw3iLKX/">cè¯­è¨€</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/pTofQIx8N/">å¾…åŠäº‹å®œ</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/8u7cjaUBn/">éšç¬”</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/JxrnYwde_/">rxjs</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/_TCq2VBQY/">ionic</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/ISScirFbw/">hybird</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/I2qOLVgn5/">java</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/l3EUiIS45/">jdk</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/4JSZ2fIFF/">commander</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/KPcAAJVPD/">cli</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/HOjS4qCUx/">npm</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/lqFA57swl/">webpack</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/saP-vOeLO/">flex</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/2w4zWQ1rD/">modernizr</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/ZFB8USksG/">fetch</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/HcGdqo85L/">é¢è¯•</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/maCy0gm-G/">kindle</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/m_CeLo5Yt/">ä¹¦ç±</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/6rUJXYvms/">crontab</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/Sy1VSsLCc/">less</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/rkzXit3IP/">calc</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/02zgiNEsk/">chmod</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/Y3JItHzej/">æ­£åˆ™</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/-rUjtgnqY/">markdown</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/7cRU4Rk01/">shadowsocks</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/Lcnh0Kloq/">rar</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/6LfZ0TlHm/">chrome</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/2_ru1bd6V/">æµè§ˆå™¨</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/v4XDvkty0/">svg-captcha</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/IfZJdWPEH4/">éªŒè¯ç </a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/dTR2pztpH/">github</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/knySerdH-/">git</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/NSyjPJZkv/">aws</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/pU8c2aJR5/">webassembly</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/Y9WXm0Dq5/">csrf</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/qL6pz1TS3V/">ç½‘ç»œå®‰å…¨</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/4iG18Qwl3/">sshd</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/OJtK_Dsle/">certbot</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/IFH5mQ48qH/">https</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/d2mdgi3zW/">sitemap</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/UsaB01y9b/">sublime</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/oVWhBDgSF/">centos</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/Q6D25qRLv/">åŸŸå</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/apvJi9fD0/">linqjs</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/3ZKlDJ0kL/">psftp</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/XATUWlxdty/">æ–‡ä»¶ä¼ è¾“</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/JqHVZntTk/">putty</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/aM2YKZNfZ/">excel</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/75lp1XTT6/">cnpm</a></li>
                
                    <li><a href="https://huxinmin.github.io/tag/eFtdyA4Ic/">åå‘ä»£ç†</a></li>
                
            </ul>
        </div>
    </div>
</div>

<header id="fh5co-header">
    <div class="container-fluid">
        <div class="row">
            <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
            <ul class="fh5co-social">
                
                    <li>
                        <a href="/"
                        
                        >
                            é¦–é¡µ
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives"
                        
                        >
                            å½’æ¡£
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags"
                        
                        >
                            æ ‡ç­¾
                        </a>
                    </li>
                
                    <li>
                        <a href="/post/about"
                        
                        >
                            å…³äº
                        </a>
                    </li>
                
            </ul>
            <div class="col-lg-12 col-md-12 text-center">
                <h1 id="fh5co-logo">
                    <a href="https://huxinmin.github.io">èƒ¡æ–°æ•çš„ä¸ªäººåšå®¢ </a>
                </h1>
            </div>
        </div>
    </div>
</header>


    <!--  <a href="#" class="fh5co-post-prev"><span>ğŸ‘ˆ Prev</span></a>-->
    <!--  <a href="#" class="fh5co-post-next"><span>Next ğŸ‘‰</span></a>-->

    <!-- ç­‰grideaå‡ºè‡ªå®šä¹‰é¡µé¢åŠŸèƒ½å†ä¼˜åŒ–ä¸€ä¸‹ -->
    
        <div class="container-fluid">
    <div class="row fh5co-post-entry single-entry">
        <article class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offset-2 col-sm-8 col-sm-offset-2 col-xs-12 col-xs-offset-0">
            <figure class="animate-box">
                
                    <img src="https://huxinmin.github.io/post-images/qian-duan-ce-shi-kuang-jia-jest-ru-men-jiao-cheng.png" alt="å‰ç«¯æµ‹è¯•æ¡†æ¶Jestå…¥é—¨æ•™ç¨‹" class="img-responsive">
                
            </figure>
            <span class="fh5co-meta animate-box">
                
                    <div class="tag-container">
                        
                            <a href="https://huxinmin.github.io/tag/GhuJji1q_/" class="tag">æµ‹è¯•, </a>
                        
                            <a href="https://huxinmin.github.io/tag/4OX23_HC0/" class="tag">jest, </a>
                        
                            <a href="https://huxinmin.github.io/tag/AzH6zVqFK/" class="tag">js, </a>
                        
                    </div>
                
            </span>
            <h2 class="fh5co-article-title animate-box">å‰ç«¯æµ‹è¯•æ¡†æ¶Jestå…¥é—¨æ•™ç¨‹</h2>
            <ol class="breadcrumb fh5co-meta fh5co-date animate-box" style="margin-bottom:0; background-color:#f8f9fa">
                <li>2020-04-20</li>
                <li>4393å­—</li>
                <li>21 min read</li>
            </ol>

            <div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0 col-xs-12 col-xs-offset-0 text-left content-article">
                <div class="row">
                    <div class="col-md-12 animate-box post-content">
                        <p> <h2 id="å‰è¨€">å‰è¨€</h2>
<p>å‰é¢çš„æ–‡ç« å·²ç»ä»‹ç»è¿‡äº†å‰ç«¯çš„ä¸€äº›å¸¸è§çš„æµ‹è¯•å·¥å…·ï¼Œä»¥åŠæµ‹è¯•çš„å¿…è¦æ€§ï¼Œé‚£ä¹ˆä»Šå¤©å°±æ¥å­¦ä¹ ä¸€ä¸‹Jestè¿™ä¸ªæµ‹è¯•æ¡†æ¶ã€‚</p>
<h2 id="jestç®€ä»‹">Jestç®€ä»‹</h2>
<p>Jestæ˜¯Fackbookå¼€å‘çš„ä¸€ä¸ªå¼€æºçš„Jsçš„å•å…ƒæµ‹è¯•å·¥å…·ï¼Œåœ¨JasmineåŸºç¡€ä¹‹ä¸Šæ¼”å˜å¼€å‘è€Œæ¥ã€‚</p>
<h2 id="why-jest">Why Jest</h2>
<p>å¸‚é¢ä¸Šå·²ç»æœ‰äº†é‚£ä¹ˆå¤šæˆç†Ÿçš„æµ‹è¯•å·¥å…·ï¼Œæ¯”å¦‚Mochaï¼ŒJasmineï¼ŒQunitç­‰ç­‰ï¼Œä¸ºä»€ä¹ˆè¦é€‰æ‹©Jestå‘¢ï¼Ÿæˆ‘è§‰å¾—Jestç›¸æ¯”äºåˆ«çš„æµ‹è¯•å·¥å…·æœ‰ç€ä»¥ä¸‹çš„ä¸€äº›ä¼˜ç‚¹ï¼š</p>
<ul>
<li>å®‰è£…é…ç½®ç®€å•ï¼Œéå¸¸å®¹æ˜“ä¸Šæ‰‹ï¼Œå‡ ä¹æ˜¯é›¶é…ç½®çš„ï¼Œé€šè¿‡npm å‘½ä»¤å®‰è£…å°±å¯ä»¥ç›´æ¥è¿è¡Œäº†</li>
<li>å†…ç½®äº†å¸¸ç”¨çš„æµ‹è¯•å·¥å…·ï¼Œæ¯”å¦‚è‡ªå¸¦æ–­è¨€ã€æµ‹è¯•è¦†ç›–ç‡å·¥å…·ç­‰ç­‰ï¼Œä¸ç”¨å†å®‰è£…åˆ«çš„æµ‹è¯•å·¥å…·</li>
<li>Jestå¯ä»¥åˆ©ç”¨å…¶ç‰¹æœ‰çš„å¿«ç…§æµ‹è¯•åŠŸèƒ½ï¼Œé€šè¿‡æ¯”å¯¹ UI ä»£ç ç”Ÿæˆçš„å¿«ç…§æ–‡ä»¶ï¼Œå®ç°å¯¹ React ç­‰å¸¸è§æ¡†æ¶çš„è‡ªåŠ¨æµ‹è¯•ã€‚</li>
<li>Jestçš„æµ‹è¯•ç”¨ä¾‹æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼Œè€Œä¸”åªæ‰§è¡Œå‘ç”Ÿæ”¹å˜çš„æ–‡ä»¶æ‰€å¯¹åº”çš„æµ‹è¯•ï¼Œæµ‹è¯•é€Ÿåº¦æ¯”è¾ƒå¿«ã€‚</li>
<li>ç›®å‰åœ¨ Github ä¸Šå…¶ star æ•°å·²ç»ç ´ä¸‡ï¼›è€Œé™¤äº† Facebook å¤–ï¼Œä¸šå†…å…¶ä»–å…¬å¸ä¹Ÿå¼€å§‹ä»å…¶å®ƒæµ‹è¯•æ¡†æ¶è½¬å‘ Jest ï¼Œæœªæ¥ Jest çš„å‘å±•è¶‹åŠ¿ä»ä¼šæ¯”è¾ƒè¿…çŒ›ã€‚</li>
</ul>
<h2 id="getting-started">Getting Started</h2>
<p>å®‰è£…</p>
<pre><code class="language-sh">yarn add --dev jest
npm install --save-dev jest
</code></pre>
<p>ç„¶åæ–°å»ºä¸€ä¸ªéœ€è¦è¿›è¡Œæµ‹è¯•çš„æ–‡ä»¶<code>sum.js</code>ï¼š</p>
<pre><code class="language-js">function sum(a, b) {
  return a + b;
}
module.exports = sum;
</code></pre>
<p>ç¼–å†™æµ‹è¯•ç”¨ä¾‹<code>sum.test.js</code>ï¼š</p>
<pre><code class="language-js">const sum = require('./sum');
test('adds 1 + 2 to equal 3', () =&gt; {
  expect(sum(1, 2)).toBe(3);
});
</code></pre>
<p>åœ¨<code>package.json</code>ä¸­ç¼–å†™å‘½ä»¤ï¼š</p>
<pre><code class="language-js">{
  &quot;scripts&quot;: {
    &quot;test&quot;: &quot;jest&quot;
  }
}
</code></pre>
<p>è¿è¡Œæµ‹è¯•ï¼š</p>
<pre><code class="language-sh">Finally, run yarn test and Jest will print this message:
PASS  ./sum.test.js
âœ“ adds 1 + 2 to equal 3 (5ms)
</code></pre>
<h2 id="jesté…ç½®">Jesté…ç½®</h2>
<p>æœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥å¯¹Jestè¿›è¡Œé…ç½®ï¼š</p>
<ul>
<li>åœ¨<code>package.json</code>ä¸­æŒ‡å®šjestå­—æ®µè¿›è¡Œé…ç½®ï¼š</li>
</ul>
<pre><code class="language-js">{
  &quot;name&quot;: &quot;my-project&quot;,
  &quot;jest&quot;: {
    &quot;verbose&quot;: true
  }
}
</code></pre>
<ul>
<li>åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»º<code>jest.config.js</code>è¿›è¡Œé…ç½®ï¼š</li>
</ul>
<pre><code class="language-js">module.exports = {
  verbose: true,
};
</code></pre>
<ul>
<li>åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨<code>--config</code>æŒ‡å®šé…ç½®Jsonæ–‡ä»¶ï¼Œæ³¨æ„ä¸èƒ½åŒ…å«<code>jest</code>å­—æ®µï¼š</li>
</ul>
<pre><code class="language-js">{
  &quot;bail&quot;: true,
  &quot;verbose&quot;: true
}
</code></pre>
<p>å¸¸è§é…ç½®é¡¹ï¼š</p>
<ul>
<li><code>automock</code> [boolean][default:false]  -- æ˜¯å¦è‡ªåŠ¨mockå¼•å…¥çš„æ¨¡å—</li>
<li><code>browser</code> [boolean][default:false] -- è§£ææ¨¡å—æ—¶éµå¾ª<code>package.json</code>ä¸­Browserifyçš„<code>browser</code>å­—æ®µ</li>
<li><code>globals</code> [object] [default: {}] -- æµ‹è¯•ç¯å¢ƒä¸­æ‰€éœ€çš„ç¯å¢ƒå˜é‡</li>
<li><code>runner</code> [string] [default: &quot;jest-runner&quot;] -- è‡ªå®šä¹‰æµ‹è¯•è¿è¡Œå™¨ï¼Œä¾‹å¦‚ï¼š<code>jest-runner-eslint</code> ï¼Œ<code>jest-runner-mocha</code>ï¼Œ<code>jest-runner-tsc</code>ï¼Œ<code>jest-runner-prettier</code></li>
<li><code>testEnvironment</code> [string] [Default: &quot;jsdom&quot;] -- æµ‹è¯•è¿è¡Œçš„ç¯å¢ƒï¼Œé»˜è®¤æ˜¯é€šè¿‡<a href="https://github.com/jsdom/jsdom" target="_blank" rel="nofollow">Jsdom</a>ç”Ÿæˆçš„æµè§ˆå™¨ç¯å¢ƒï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<code>node</code>æ¥æŒ‡å®š<code>node</code>ç¯å¢ƒã€‚</li>
<li><code>verbose</code> [boolean] [default: false]  -- æŒ‡ç¤ºæ¯ä¸ªæµ‹è¯•ç”¨ä¾‹æ˜¯å¦æŠ¥å‘ŠçŠ¶æ€</li>
<li>æ›´å¤šé…ç½®é¡¹è¯·å‚è€ƒ<a href="https://facebook.github.io/jest/docs/en/configuration.html" target="_blank" rel="nofollow">https://facebook.github.io/jest/docs/en/configuration.html</a></li>
</ul>
<h2 id="jest-cli">Jest CLI</h2>
<p>ä½ ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å‘½ä»¤è¡Œè¿è¡ŒJestå‘½ä»¤ï¼š</p>
<pre><code class="language-sh">jest [--options]
</code></pre>
<p>ä¾‹å­ï¼š</p>
<pre><code class="language-js">jest   //è¿è¡Œæ‰€æœ‰æµ‹è¯•
jest path/to/my-test.js  //æµ‹è¯•æŒ‡å®šæ–‡ä»¶
jest -o  //æµ‹è¯•git/huä¸­æ”¹åŠ¨çš„æ²¡æœ‰æäº¤çš„æ–‡ä»¶
jest --findRelatedTests path/to/fileA.js path/to/fileB.js  //æµ‹è¯•ç›¸å…³çš„æ–‡ä»¶
jest -t name-of-spec  //è¿è¡Œdescribeæˆ–è€…testä¸­ç¬¦åˆåå­—çš„æµ‹è¯•ç”¨ä¾‹
jest --watch       //runs jest -o by default
jest --watchAll    //runs all tests  
</code></pre>
<p>å¸¸è§çš„<code>options</code>ï¼š</p>
<ul>
<li><code>--bail</code>ç¼©å†™<code>-b</code>ä¸€æ—¦æµ‹è¯•ç”¨ä¾‹å¤±è´¥ç«‹åˆ»é€€å‡º</li>
<li><code>--cache</code>æ˜¯å¦å¼€å¯ç¼“å­˜ï¼Œé»˜è®¤æ˜¯<code>true</code>,å–æ¶ˆç¼“å­˜ä½¿ç”¨<code>--no-cache</code>ï¼Œå¦‚æœä½ æƒ³è¦è§‚æµ‹ç¼“å­˜çš„è¯ï¼Œä½¿ç”¨<code>--showConfig</code>ç„¶åçœ‹<code>cacheDirectory</code>çš„å€¼ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨<code>--clearCache</code>æ¸…é™¤ç¼“å­˜</li>
<li><code>--colors</code>å¼ºåˆ¶å¼€å¯è¾“å‡ºé«˜äº®</li>
<li><code>--config=&lt;path&gt;</code>ç¼©å†™<code>-c</code>ï¼ŒæŒ‡å®šé…ç½®æ–‡ä»¶</li>
<li><code>--coverage</code>è¾“å‡ºæµ‹è¯•è¦†ç›–ç‡</li>
<li><code>--expand</code>ç¼©å†™<code>-e</code>æ˜¾ç¤ºå…¨éƒ¨çš„<code>diffs</code>å’Œé”™è¯¯è€Œä¸æ˜¯ä¿®è¡¥</li>
<li><code>--json</code>æ‰“å°å‡ºæµ‹è¯•ç»“æœçš„Jsonå½¢å¼</li>
<li><code>--notify</code>æ¿€æ´»é€šçŸ¥é€‰é¡¹</li>
<li><code>--onlyChanged</code>ç¼©å†™<code>-o</code>ï¼Œåªé’ˆå¯¹æ”¹åŠ¨çš„æ–‡ä»¶è¿è¡Œæµ‹è¯•ï¼Œåªåœ¨git/hgä»“åº“ä¸­ï¼Œå¹¶ä¸”åªæœ‰é™æ€ä¾èµ–æ—¶æœ‰ç”¨</li>
<li><code>--verbose</code>åˆ†å±‚æ˜¾ç¤ºæ¯ä¸ªç‹¬ç«‹çš„æµ‹è¯•ç”¨ä¾‹</li>
<li><code>--version</code>ç¼©å†™<code>-v</code>è¾“å‡ºç‰ˆæœ¬å·</li>
<li>æ›´å¤šè¯·å‚è€ƒ<a href="https://facebook.github.io/jest/docs/en/cli.html" target="_blank" rel="nofollow">https://facebook.github.io/jest/docs/en/cli.html</a></li>
</ul>
<h2 id="matchers">Matchers</h2>
<p>Jestä¸­çš„Matchersç±»ä¼¼äºæ–­è¨€åº“é‡Œé¢çš„æ–­è¨€åˆ¤æ–­ã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„Matchersï¼š</p>
<ul>
<li><code>toBe()</code>åˆ¤æ–­æ˜¯å¦æ˜¯é¢„æœŸçš„å€¼ï¼ˆä¸å¯ç”¨äºæµ®ç‚¹æ•°ï¼Œæµ®ç‚¹æ•°è¯·ç”¨toBeCloseToï¼‰</li>
<li><code>toBeCloseTo(number, numDigits)</code>åˆ¤æ–­æµ®ç‚¹æ•°è¿ç®—æ˜¯å¦ç›¸ç­‰</li>
<li><code>toEqual()</code>åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰</li>
<li><code>any(constructor)</code>åŒ¹é…ä»»ä½•ç”±ç»™å®šæ„é€ å™¨ç”Ÿæˆçš„å¯¹è±¡</li>
<li><code>toBeNull()</code>åŒ¹é…Null</li>
<li><code>toBeUndefined()</code>åŒ¹é…undefined</li>
<li><code>toBeDefined()</code>æ£€æŸ¥æ˜¯å¦å®šä¹‰</li>
<li><code>toBeTruthy()</code>ä¸å…³å¿ƒå€¼æ˜¯å¤šå°‘ï¼Œåªå…³å¿ƒè½¬æ¢ä¸ºå¸ƒå°”å€¼ä»¥åæ˜¯å¦ä¸ºçœŸ</li>
<li><code>toBeFalsy()</code>ä¸å…³å¿ƒå€¼æ˜¯å¤šå°‘ï¼Œåªå…³å¿ƒè½¬æ¢ä¸ºå¸ƒå°”å€¼ä»¥åæ˜¯å¦ä¸ºå‡</li>
<li><code>toBeGreaterThan()</code>å¤§äº</li>
<li><code>toBeGreaterThanOrEqual()</code>å¤§äºç­‰äº</li>
<li><code>toBeLessThan()</code>å°äº</li>
<li><code>toBeLessThanOrEqual()</code>å°äºç­‰äº</li>
<li><code>toMatch()</code>åŒ¹é…æ­£åˆ™</li>
<li><code>toContain()</code>åˆ¤æ–­æ•°ç»„é‡Œæ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ </li>
<li><code>toThrow()</code>å‡½æ•°è°ƒç”¨åæ˜¯å¦ä¼šæŠ›å‡ºé”™è¯¯</li>
<li><code>toHaveBeenCalled()</code>å‡½æ•°æ˜¯å¦è¢«è°ƒç”¨</li>
<li><code>not</code>å–å</li>
<li><code>resolves</code>è·å–promiseå¯¹è±¡çš„resolveså€¼</li>
<li>æ›´å¤šè¯·å‚è€ƒ<a rel="nofollow" target="_blank" href="https://facebook.github.io/jest/docs/en/expect.html">https://facebook.github.io/jest/docs/en/expect.html</a></li>
</ul>
<h2 id="æµ‹è¯•å¼‚æ­¥ä»£ç ">æµ‹è¯•å¼‚æ­¥ä»£ç </h2>
<p>Jestæœ‰4ç§æ–¹æ³•å¯ä»¥æµ‹è¯•å¼‚æ­¥çš„ä»£ç ï¼š</p>
<ol>
<li>å›è°ƒå‡½æ•°<br>
åœ¨<code>test</code>è¯­å¥ä¸­åŠ å…¥<code>done</code>å‚æ•°ï¼Œç„¶ååœ¨å›è°ƒå‡½æ•°ä¸­æµ‹è¯•è¯­å¥ç»“æŸåæ‰§è¡Œ<code>done()</code>å³å¯ï¼š</li>
</ol>
<pre><code class="language-js">test('the data is peanut butter', done =&gt; {
  function callback(data) {
    expect(data).toBe('peanut butter');
    done();
  }

  fetchData(callback);
});
</code></pre>
<ol start="2">
<li>Promises<br>
åªè¦åœ¨<code>test</code>è¯­å¥ä¸­ç›´æ¥è¿”å›ä¸€ä¸ª<code>promise</code>å³å¯ï¼Œå¦‚æœ<code>promise</code>çŠ¶æ€ä¸º<code>rejected</code>ï¼Œåˆ™æµ‹è¯•ç”¨ä¾‹è‡ªåŠ¨å¤±è´¥ã€‚</li>
</ol>
<pre><code class="language-js">test('the data is peanut butter', () =&gt; {
  expect.assertions(1);
  return fetchData().then(data =&gt; {
    expect(data).toBe('peanut butter');
  });
});
</code></pre>
<p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<code>catch</code>æ¥æœŸæœ›<code>rejected</code>çš„å‡ºç°</p>
<pre><code class="language-js">test('the fetch fails with an error', () =&gt; {
  expect.assertions(1);
  return fetchData().catch(e =&gt; expect(e).toMatch('error'));
});
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œéœ€è¦æ·»åŠ <code>expect.assertions(number)</code>æ¥éªŒè¯æ–­è¨€çš„æ¬¡æ•°ï¼Œä¸æ·»åŠ çš„è¯ï¼Œåˆ™æ— æ³•ä½¿æµ‹è¯•ç”¨ä¾‹è‡ªåŠ¨å¤±è´¥ã€‚<br>
3. <code>.resolves / .rejects</code></p>
<pre><code class="language-js">test('the data is peanut butter', () =&gt; {
  expect.assertions(1);
  return expect(fetchData()).resolves.toBe('peanut butter');
});
test('the fetch fails with an error', () =&gt; {
  expect.assertions(1);
  return expect(fetchData()).rejects.toMatch('error');
});
</code></pre>
<ol start="4">
<li><code>Async/Await</code></li>
</ol>
<pre><code class="language-js">test('the data is peanut butter', async () =&gt; {
  expect.assertions(1);
  const data = await fetchData();
  expect(data).toBe('peanut butter');
});
test('the fetch fails with an error', async () =&gt; {
  expect.assertions(1);
  try {
    await fetchData();
  } catch (e) {
    expect(e).toMatch('error');
  }
});
</code></pre>
<p><code>async/await</code>è¿˜å¯ä»¥å’Œ<code>resolves/rejects</code>ç»„åˆä½¿ç”¨</p>
<pre><code class="language-js">test('the data is peanut butter', async () =&gt; {
  expect.assertions(1);
  await expect(fetchData()).resolves.toBe('peanut butter');
});
test('the fetch fails with an error', async () =&gt; {
  expect.assertions(1);
  await expect(fetchData()).rejects.toMatch('error');
});
</code></pre>
<h2 id="é’©å­å‡½æ•°">é’©å­å‡½æ•°</h2>
<pre><code class="language-js">beforeEach()  -- æ¯ä¸ªtestæ‰§è¡Œä¹‹å‰æ‰§è¡Œ
afterEach()   -- æ¯ä¸ªtestæ‰§è¡Œä¹‹åæ‰§è¡Œ
beforeAll()   -- åœ¨æ‰€æœ‰testæ‰§è¡Œä¹‹å‰æ‰§è¡Œä¸€æ¬¡
afterAll()    -- åœ¨æ‰€æœ‰testæ‰§è¡Œä¹‹åæ‰§è¡Œä¸€æ¬¡
</code></pre>
<p>é»˜è®¤åœ°ï¼Œè¿™äº›é’©å­å‡½æ•°çš„ä½œç”¨åŸŸæ˜¯æ•´ä¸ªæ–‡ä»¶ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<code>describe</code>æ¥è¿›è¡Œåˆ†ç»„ï¼Œå¤–éƒ¨çš„<code>before</code>å…ˆäº<code>describe</code>å†…éƒ¨çš„<code>before</code>è¿è¡Œï¼Œ<code>after</code>åäº<code>describe</code>å†…éƒ¨çš„<code>after</code>è¿è¡Œã€‚ä¸‹é¢çš„ä¾‹å­å¯ä»¥å¾ˆæ¸…æ¥šå¸®åŠ©ç†è§£é’©å­å‡½æ•°è¿è¡Œçš„å…ˆåï¼š</p>
<pre><code class="language-js">beforeAll(() =&gt; console.log('1 - beforeAll'));
afterAll(() =&gt; console.log('1 - afterAll'));
beforeEach(() =&gt; console.log('1 - beforeEach'));
afterEach(() =&gt; console.log('1 - afterEach'));
test('', () =&gt; console.log('1 - test'));
describe('Scoped / Nested block', () =&gt; {
  beforeAll(() =&gt; console.log('2 - beforeAll'));
  afterAll(() =&gt; console.log('2 - afterAll'));
  beforeEach(() =&gt; console.log('2 - beforeEach'));
  afterEach(() =&gt; console.log('2 - afterEach'));
  test('', () =&gt; console.log('2 - test'));
});
// 1 - beforeAll
// 1 - beforeEach
// 1 - test
// 1 - afterEach
// 2 - beforeAll
// 1 - beforeEach
// 2 - beforeEach
// 2 - test
// 2 - afterEach
// 1 - afterEach
// 2 - afterAll
// 1 - afterAll
</code></pre>
<p>Jestä¼šå…ˆæ‰§è¡Œæ‰€æœ‰çš„<code>describe</code>ç„¶åå†æŒ‰é¡ºåºæ‰§è¡Œ<code>test</code>:</p>
<pre><code class="language-js">describe('outer', () =&gt; {
  console.log('describe outer-a');
  describe('describe inner 1', () =&gt; {
    console.log('describe inner 1');
    test('test 1', () =&gt; {
      console.log('test for describe inner 1');
      expect(true).toEqual(true);
    });
  });
  console.log('describe outer-b');
  test('test 1', () =&gt; {
    console.log('test for describe outer');
    expect(true).toEqual(true);
  });
  describe('describe inner 2', () =&gt; {
    console.log('describe inner 2');
    test('test for describe inner 2', () =&gt; {
      console.log('test for describe inner 2');
      expect(false).toEqual(false);
    });
  });
  console.log('describe outer-c');
});
// describe outer-a
// describe inner 1
// describe outer-b
// describe inner 2
// describe outer-c
// test for describe inner 1
// test for describe outer
// test for describe inner 2
</code></pre>
<h2 id="mock-functions">Mock Functions</h2>
<p>åœ¨å†™å•å…ƒæµ‹è¯•çš„æ—¶å€™æˆ‘ä»¬é€šå¸¸ä¼šæ ¹æ®æ¥å£æ¥Mockæ¥å£çš„å®ç°ï¼Œæ¯”å¦‚ä½ è¦æµ‹è¯•æŸä¸ªç±»ä¸­çš„æŸä¸ªæ–¹æ³•ï¼Œè€Œè¿™ä¸ªæ–¹æ³•åˆä¾èµ–äº†å¤–éƒ¨çš„ä¸€äº›æ¥å£çš„å®ç°ï¼Œä»å•å…ƒæµ‹è¯•çš„è§’åº¦æ¥è¯´æˆ‘åªå…³å¿ƒæµ‹è¯•çš„æ–¹æ³•çš„å†…éƒ¨é€»è¾‘ï¼Œå´å¹¶ä¸å…³æ³¨ä¸å½“å‰ç±»æœ¬èº«ä¾èµ–çš„å®ç°ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šå¸¸ä¼šMockæ‰ä¾èµ–æ¥å£çš„è¿”å›ï¼Œå› ä¸ºæˆ‘ä»¬çš„æµ‹è¯•é‡ç‚¹åœ¨äºç‰¹å®šçš„æ–¹æ³•ï¼Œåœ¨Jestä¸­åŒæ ·æä¾›äº†Mockçš„åŠŸèƒ½ã€‚</p>
<p>Mock å‡½æ•°å¯ä»¥è½»æ¾åœ°æµ‹è¯•ä»£ç ä¹‹é—´çš„è¿æ¥â€”â€”è¿™é€šè¿‡æ“¦é™¤å‡½æ•°çš„å®é™…å®ç°ï¼Œæ•è·å¯¹å‡½æ•°çš„è°ƒç”¨ ( ä»¥åŠåœ¨è¿™äº›è°ƒç”¨ä¸­ä¼ é€’çš„å‚æ•°) ï¼Œåœ¨ä½¿ç”¨ new å®ä¾‹åŒ–æ—¶æ•è·æ„é€ å‡½æ•°çš„å®ä¾‹ï¼Œæˆ–å…è®¸æµ‹è¯•æ—¶é…ç½®è¿”å›å€¼çš„å½¢å¼æ¥å®ç°ã€‚Jestä¸­æœ‰ä¸¤ç§æ–¹å¼çš„Mock Functionï¼Œä¸€ç§æ˜¯åˆ©ç”¨Jestæä¾›çš„Mock Functionåˆ›å»ºï¼Œå¦å¤–ä¸€ç§æ˜¯æ‰‹åŠ¨åˆ›å»ºæ¥è¦†å†™æœ¬èº«çš„ä¾èµ–å®ç°ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬è¦æµ‹è¯•å‡½æ•° forEach çš„å†…éƒ¨å®ç°ï¼Œè¿™ä¸ªå‡½æ•°ä¸ºä¼ å…¥çš„æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">function forEach(items, callback) {
  for (let index = 0; index &lt; items.length; index++) {
    callback(items[index]);
  }
}
</code></pre>
<p>ä¸ºäº†æµ‹è¯•æ­¤å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª mock å‡½æ•°ï¼Œç„¶åæ£€æŸ¥ mock å‡½æ•°çš„çŠ¶æ€æ¥ç¡®ä¿å›è°ƒå‡½æ•°å¦‚æœŸè°ƒç”¨ã€‚</p>
<pre><code class="language-js">const mockCallback = jest.fn();
forEach([0, 1], mockCallback);
// The mock function is called twice
expect(mockCallback.mock.calls.length).toBe(2);
// The first argument of the first call to the function was 0
expect(mockCallback.mock.calls[0][0]).toBe(0);
// The first argument of the second call to the function was 1
expect(mockCallback.mock.calls[1][0]).toBe(1);
</code></pre>
<p>å‡ ä¹æ‰€æœ‰çš„Mock Functionéƒ½å¸¦æœ‰ <code>.mock</code>çš„å±æ€§ï¼Œå®ƒä¿å­˜äº†æ­¤å‡½æ•°è¢«è°ƒç”¨çš„ä¿¡æ¯ã€‚ <code>.mock</code> å±æ€§è¿˜è¿½è¸ªæ¯æ¬¡è°ƒç”¨æ—¶ <code>this</code>çš„å€¼ï¼Œæ‰€ä»¥ä¹Ÿè®©æ£€è§† <code>this</code> çš„å€¼æˆä¸ºå¯èƒ½ï¼š</p>
<pre><code class="language-js">const myMock = jest.fn();
const a = new myMock();
const b = {};
const bound = myMock.bind(b);
bound();
console.log(myMock.mock.instances);
// &gt; [ &lt;a&gt;, &lt;b&gt; ]
</code></pre>
<p>åœ¨æµ‹è¯•ä¸­ï¼Œéœ€è¦å¯¹å‡½æ•°å¦‚ä½•è¢«è°ƒç”¨ï¼Œæˆ–è€…å®ä¾‹åŒ–åšæ–­è¨€æ—¶ï¼Œè¿™äº› mock æˆå‘˜å˜é‡å¾ˆæœ‰å¸®åŠ©æ„ä¹‰ï¸°</p>
<pre><code class="language-js">// The function was called exactly once
expect(someMockFunction.mock.calls.length).toBe(1);
// The first arg of the first call to the function was 'first arg'
expect(someMockFunction.mock.calls[0][0]).toBe('first arg');
// The second arg of the first call to the function was 'second arg'
expect(someMockFunction.mock.calls[0][1]).toBe('second arg');
// This function was instantiated exactly twice
expect(someMockFunction.mock.instances.length).toBe(2);
// The object returned by the first instantiation of this function
// had a `name` property whose value was set to 'test'
expect(someMockFunction.mock.instances[0].name).toEqual('test');
</code></pre>
<p>Mock å‡½æ•°ä¹Ÿå¯ä»¥ç”¨äºåœ¨æµ‹è¯•æœŸé—´å°†æµ‹è¯•å€¼æ³¨å…¥æ‚¨çš„ä»£ç ï¸°</p>
<pre><code class="language-js">const myMock = jest.fn();
console.log(myMock());
// &gt; undefined
myMock
  .mockReturnValueOnce(10)
  .mockReturnValueOnce('x')
  .mockReturnValue(true);
console.log(myMock(), myMock(), myMock(), myMock());
// &gt; 10, 'x', true, true
</code></pre>
<p>å¦‚æœä½ éœ€è¦å®šä¹‰ä¸€ä¸ªæ¨¡æ‹Ÿçš„å‡½æ•°ï¼Œå®ƒä»å¦ä¸€ä¸ªæ¨¡å—ä¸­åˆ›å»ºçš„é»˜è®¤å®ç°ï¼Œ<code>mockImplementation</code>æ–¹æ³•éå¸¸æœ‰ç”¨ï¸°</p>
<pre><code class="language-js">// foo.js
module.exports = function() {
  // some implementation;
};
// test.js
jest.mock('../foo'); // this happens automatically with automocking
const foo = require('../foo');
// foo is a mock function
foo.mockImplementation(() =&gt; 42);
foo();
// &gt; 42
</code></pre>
<p>å½“ä½ éœ€è¦å¤šä¸ªå‡½æ•°è°ƒç”¨äº§ç”Ÿä¸åŒçš„ç»“æœæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>mockImplementationOnce</code> æ–¹æ³•ï¼š</p>
<pre><code class="language-js">const myMockFn = jest
  .fn(() =&gt; 'default')
  .mockImplementationOnce(() =&gt; 'first call')
  .mockImplementationOnce(() =&gt; 'second call');
console.log(myMockFn(), myMockFn(), myMockFn(), myMockFn());
// &gt; 'first call', 'second call', 'default', 'default'
</code></pre>
<p>å¯¹äºæœ‰é€šå¸¸é“¾æ¥çš„æ–¹æ³•ï¼ˆå› æ­¤æ€»æ˜¯éœ€è¦è¿”å›thisï¼‰çš„æƒ…å†µï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªè¯­æ³•ç³–çš„APIä»¥<code>.mockReturnThis()</code>å‡½æ•°çš„å½¢å¼æ¥ç®€åŒ–å®ƒï¼Œå®ƒä¹Ÿä½äºæ‰€æœ‰æ¨¡æ‹Ÿå™¨ä¸Šï¼š</p>
<pre><code class="language-js">const myObj = {
  myMethod: jest.fn().mockReturnThis(),
};
// is the same as
const otherObj = {
  myMethod: jest.fn(function() {
    return this;
  }),
};
</code></pre>
<p>ä½ ä¹Ÿå¯ä»¥ç»™ä½ çš„Mock Functionèµ·ä¸€ä¸ªå‡†ç¡®çš„åå­—ï¼Œè¿™æ ·æœ‰åŠ©äºä½ åœ¨æµ‹è¯•é”™è¯¯çš„æ—¶å€™åœ¨è¾“å‡ºçª—å£å®šä½åˆ°å…·ä½“çš„Function</p>
<pre><code class="language-js">const myMockFn = jest
  .fn()
  .mockReturnValue('default')
  .mockImplementation(scalar =&gt; 42 + scalar)
  .mockName('add42');
</code></pre>
<p>æœ€åï¼Œä¸ºäº†æ›´ç®€å•åœ°è¯´æ˜å¦‚ä½•è°ƒç”¨mockå‡½æ•°ï¼Œæˆ‘ä»¬ä¸ºæ‚¨æ·»åŠ äº†ä¸€äº›è‡ªå®šä¹‰åŒ¹é…å™¨å‡½æ•°ï¼š</p>
<pre><code class="language-js">// The mock function was called at least once
expect(mockFunc).toBeCalled();
// The mock function was called at least once with the specified args
expect(mockFunc).toBeCalledWith(arg1, arg2);
// The last call to the mock function was called with the specified args
expect(mockFunc).lastCalledWith(arg1, arg2);
// All calls and the name of the mock is written as a snapshot
expect(mockFunc).toMatchSnapshot();
</code></pre>
<p>è¿™äº›åŒ¹é…å™¨æ˜¯çœŸçš„åªæ˜¯è¯­æ³•ç³–çš„å¸¸è§å½¢å¼çš„æ£€æŸ¥ <code>.mock</code> å±æ€§ã€‚ ä½ æ€»å¯ä»¥æ‰‹åŠ¨è‡ªå·±å¦‚æœæ˜¯æ›´åˆä½ çš„å£å‘³ï¼Œæˆ–å¦‚æœä½ éœ€è¦åšä¸€äº›æ›´å…·ä½“çš„äº‹æƒ…ï¸°</p>
<pre><code class="language-js">// The mock function was called at least once
expect(mockFunc.mock.calls.length).toBeGreaterThan(0);
// The mock function was called at least once with the specified args
expect(mockFunc.mock.calls).toContain([arg1, arg2]);
// The last call to the mock function was called with the specified args
expect(mockFunc.mock.calls[mockFunc.mock.calls.length - 1]).toEqual([
  arg1,
  arg2,
]);
// The first arg of the last call to the mock function was `42`
// (note that there is no sugar helper for this specific of an assertion)
expect(mockFunc.mock.calls[mockFunc.mock.calls.length - 1][0]).toBe(42);
// A snapshot will check that a mock was invoked the same number of times,
// in the same order, with the same arguments. It will also assert on the name.
expect(mockFunc.mock.calls).toEqual([[arg1, arg2]]);
expect(mockFunc.mock.getMockName()).toBe('a mock name');
</code></pre>
<h2 id="jestå¹³å°">Jestå¹³å°</h2>
<p>æ‚¨å¯ä»¥æŒ‘é€‰Jestçš„ç‰¹å®šåŠŸèƒ½ï¼Œå¹¶å°†å®ƒä»¬ä½œä¸ºç‹¬ç«‹è½¯ä»¶åŒ…ä½¿ç”¨ï¼š</p>
<ul>
<li>jest-changed-files åŒ¹é…git/hgä»“åº“ä¸­æ”¹åŠ¨çš„æ–‡ä»¶</li>
</ul>
<pre><code class="language-js">const {getChangedFilesForRoots} = require('jest-changed-files');
// print the set of modified files since last commit in the current repo
getChangedFilesForRoots(['./'], {
  lastCommit: true,
}).then(result =&gt; console.log(result.changedFiles));
</code></pre>
<ul>
<li>jest-diff å¯è§†åŒ–å·®å¼‚å¯¹æ¯”</li>
</ul>
<pre><code class="language-js">const diff = require('jest-diff');
const a = {a: {b: {c: 5}}};
const b = {a: {b: {c: 6}}};
const result = diff(a, b);
// print diff
console.log(result);
 Expected
 Received
  Object {
    &quot;a&quot;: Object {
      &quot;b&quot;: Object {
       &quot;c&quot;: 5,
       &quot;c&quot;: 6,
      },
    },
  }
</code></pre>
<ul>
<li>jest-docblock æå–è§£ææ³¨é‡Šï¼Œå¯¼å‡ºå„ç§åŠŸèƒ½æ¥æ“ä½œæ³¨é‡Šå—å†…çš„æ•°æ®ã€‚</li>
</ul>
<pre><code class="language-js">const {parseWithComments} = require('jest-docblock');
const code = `
/**
 * This is a sample
 *
 * @flow
 */
 console.log('Hello World!');
`;
const parsed = parseWithComments(code);
// prints an object with two attributes: comments and pragmas.
console.log(parsed);
{ comments: '/**\nThis is a sample\n\n/\n \n console.log(\'Hello World!\');',
  pragmas: { flow: '' } }
</code></pre>
<ul>
<li>jest-get-type è·å–åŸç”Ÿçš„jsçš„æ•°æ®ç±»å‹</li>
</ul>
<pre><code class="language-js">const getType = require('jest-get-type');
const array = [1, 2, 3];
const nullValue = null;
const undefinedValue = undefined;
// prints 'array'
console.log(getType(array));
// prints 'null'
console.log(getType(nullValue));
// prints 'undefined'
console.log(getType(undefinedValue));
</code></pre>
<ul>
<li>jest-validate éªŒè¯ç”¨æˆ·æäº¤çš„é…ç½®é¡¹</li>
<li>jest-worker æ‰§è¡Œå¹¶è¡Œä»»åŠ¡</li>
<li>pretty-format æ ¼å¼ç¾åŒ–</li>
</ul>
<pre><code class="language-js">const prettyFormat = require('pretty-format');
const val = {object: {}};
val.circularReference = val;
val[Symbol('foo')] = 'foo';
val.map = new Map([['prop', 'value']]);
val.array = [-0, Infinity, NaN];
console.log(prettyFormat(val));
Object {
  &quot;array&quot;: Array [
    -0,
    Infinity,
    NaN,
  ],
  &quot;circularReference&quot;: [Circular],
  &quot;map&quot;: Map {
    &quot;prop&quot; =&gt; &quot;value&quot;,
  },
  &quot;object&quot;: Object {},
  Symbol(foo): &quot;foo&quot;,
}
</code></pre>
<h2 id="es6-class-mocks">Es6 Class Mocks</h2>
<p>ES6çš„ç±»æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°çš„è¯­æ³•ç³–ï¼Œæ‰€ä»¥ä½ å¯ä»¥ä½¿ç”¨mockå‡½æ•°æ¥mock ES6çš„ç±»ã€‚ä¸‹é¢æˆ‘ä»¬å°†åˆ›å»ºä¸¤ä¸ªç±»ä¸€ä¸ªæ˜¯<code>SoundPlayer</code>ç±»ï¼Œä¸€ä¸ª<code>SoundPlayerConsumer</code>ç±»ä¾èµ–äº†<code>SoundPlayer</code>ç±»ã€‚</p>
<pre><code class="language-js">// sound-player.js
export default class SoundPlayer {
  constructor() {
    this.foo = 'bar';
  }
  playSoundFile(fileName) {
    console.log('Playing sound file ' + fileName);
  }
}
</code></pre>
<pre><code class="language-js">// sound-player-consumer.js
import SoundPlayer from './sound-player';
export default class SoundPlayerConsumer {
  constructor() {
    this.soundPlayer = new SoundPlayer();
  }
  playSomethingCool() {
    const coolSoundFileName = 'song.mp3';
    this.soundPlayer.playSoundFile(coolSoundFileName);
  }
}
</code></pre>
<p>ä¸‹é¢ä»‹ç»4ç§æ–¹æ³•æ¥åˆ›å»ºES6çš„Mock:</p>
<ol>
<li>
<h4 id="è‡ªåŠ¨mock">è‡ªåŠ¨mock</h4>
</li>
</ol>
<p>è°ƒç”¨<code>jest.mock('./sound-player')</code>æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªè‡ªåŠ¨çš„mockï¼Œä½ å¯ä»¥ç”¨æ¥ç›‘å¬æ„é€ å‡½æ•°å’Œå®ƒæ‰€æœ‰çš„æ–¹æ³•ï¼Œå®ƒä¼šæ›¿æ¢æ„é€ å‡½æ•°å’Œæ–¹æ³•å¹¶ä¸”æ€»æ˜¯ä¼šè¿”å›<code>undefined</code>ï¼Œæ–¹æ³•çš„è°ƒç”¨ä¼šå­˜å‚¨åœ¨<code>theAutomaticMock.mock.instances[index].methodName.mock.calls</code>ã€‚</p>
<pre><code class="language-js">import SoundPlayer from './sound-player';
import SoundPlayerConsumer from './sound-player-consumer';
jest.mock('./sound-player'); // SoundPlayer is now a mock constructor
beforeEach(() =&gt; {
  // Clear all instances and calls to constructor and all methods:
  SoundPlayer.mockClear();
});
it('We can check if the consumer called the class constructor', () =&gt; {
  const soundPlayerConsumer = new SoundPlayerConsumer();
  expect(SoundPlayer).toHaveBeenCalledTimes(1);
});
it('We can check if the consumer called a method on the class instance', () =&gt; {
  // Show that mockClear() is working:
  expect(SoundPlayer).not.toHaveBeenCalled();
  const soundPlayerConsumer = new SoundPlayerConsumer();
  // Constructor should have been called again:
  expect(SoundPlayer).toHaveBeenCalledTimes(1);
  const coolSoundFileName = 'song.mp3';
  soundPlayerConsumer.playSomethingCool();
  // mock.instances is available with automatic mocks:
  const mockSoundPlayerInstance = SoundPlayer.mock.instances[0];
  const mockPlaySoundFile = mockSoundPlayerInstance.playSoundFile;
  expect(mockPlaySoundFile.mock.calls[0][0]).toEqual(coolSoundFileName);
  // Equivalent to above check:
  expect(mockPlaySoundFile).toHaveBeenCalledWith(coolSoundFileName);
  expect(mockPlaySoundFile).toHaveBeenCalledTimes(1);
});
</code></pre>
<ol start="2">
<li>
<h4 id="æ‰‹åŠ¨mock">æ‰‹åŠ¨mock</h4>
</li>
</ol>
<p>ä½ ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ª<code>_mock_</code>æ–‡ä»¶å¤¹ï¼Œå¯ä»¥è‡ªå·±å®šä¹‰mockå‡½æ•°çš„å®ç°ã€‚</p>
<pre><code class="language-js">// __mocks__/sound-player.js
// Import this named export into your test file:
export const mockPlaySoundFile = jest.fn();
const mock = jest.fn().mockImplementation(() =&gt; {
  return {playSoundFile: mockPlaySoundFile};
});
export default mock;
</code></pre>
<p>ç„¶åå¯¼å…¥mockå‡½æ•°ï¼š</p>
<pre><code class="language-js">// sound-player-consumer.test.js
import SoundPlayer, {mockPlaySoundFile} from './sound-player';
import SoundPlayerConsumer from './sound-player-consumer';
jest.mock('./sound-player'); // SoundPlayer is now a mock constructor
beforeEach(() =&gt; {
  // Clear all instances and calls to constructor and all methods:
  SoundPlayer.mockClear();
  mockPlaySoundFile.mockClear();
});
it('We can check if the consumer called the class constructor', () =&gt; {
  const soundPlayerConsumer = new SoundPlayerConsumer();
  expect(SoundPlayer).toHaveBeenCalledTimes(1);
});
it('We can check if the consumer called a method on the class instance', () =&gt; {
  const soundPlayerConsumer = new SoundPlayerConsumer();
  const coolSoundFileName = 'song.mp3';
  soundPlayerConsumer.playSomethingCool();
  expect(mockPlaySoundFile).toHaveBeenCalledWith(coolSoundFileName);
});
</code></pre>
<ol start="3">
<li>
<h4 id="è°ƒç”¨jestmockå¹¶ä¼ é€’ä¸€ä¸ªå·¥å‚å‡½æ•°å‚æ•°">è°ƒç”¨<code>jest.mock()</code>å¹¶ä¼ é€’ä¸€ä¸ªå·¥å‚å‡½æ•°å‚æ•°</h4>
</li>
</ol>
<p>ä½ å¯ä»¥ä½¿ç”¨<code>jest.mock(path, moduleFactory)</code>æ¥åˆ›å»ºä¸€ä¸ªmockå‡½æ•°ï¼Œä½†æ˜¯è¿™ä¸ªå·¥å‚å‡½æ•°å¿…é¡»è¦è¿”å›ä¸€ä¸ªmockå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯<code>higher-order function (HOF)</code>ã€‚</p>
<pre><code class="language-js">import SoundPlayer from './sound-player';
const mockPlaySoundFile = jest.fn();
jest.mock('./sound-player', () =&gt; {
  return jest.fn().mockImplementation(() =&gt; {
    return {playSoundFile: mockPlaySoundFile};
  });
});
</code></pre>
<p>ä½¿ç”¨å·¥å‚å‡½æ•°å‚æ•°çš„ä¸è¶³ä¹‹å¤„åœ¨äºï¼Œ<code>jest.mock()</code>å‡½æ•°ä¼šåœ¨ä¸€å¼€å§‹å°±è¢«è°ƒç”¨ï¼Œæ‰€ä»¥ä½ æ— æ³•ä¸€å¼€å§‹å°±å®šä¹‰ä¸€ä¸ªå˜é‡ç„¶ååœ¨å·¥å‚å‡½æ•°ä¸­ä½¿ç”¨ã€‚<br>
4. #### ä½¿ç”¨<code>mockImplementation()</code>æˆ–è€…<code>mockImplementationOnce()</code>æ¥æ”¹å˜mock<br>
ä½ å¯ä»¥ä½¿ç”¨<code>mockImplementation()</code>æˆ–è€…<code>mockImplementationOnce()</code>åœ¨é’©å­å‡½æ•°ä¸­ç¨åæ¥æ”¹å˜mockå‡½æ•°çš„å®ç°ï¼š</p>
<pre><code class="language-js">import SoundPlayer from './sound-player';
jest.mock('./sound-player');
describe('When SoundPlayer throws an error', () =&gt; {
  beforeAll(() =&gt; {
    SoundPlayer.mockImplementation(() =&gt; {
      return {
        playSoundFile: () =&gt; {
          throw new Error('Test error');
        },
      };
    });
  });
  it('Should throw an error when calling playSomethingCool', () =&gt; {
    const soundPlayerConsumer = new SoundPlayerConsumer();
    expect(() =&gt; soundPlayerConsumer.playSomethingCool()).toThrow();
  });
});
</code></pre>
<h2 id="æ•´åˆwebpack">æ•´åˆWebpack</h2>
<p>åªéœ€è¦åœ¨<code>package.json</code>å¯¹jestå­—æ®µè¿›è¡Œä¸€äº›é…ç½®å³å¯ï¼š</p>
<pre><code class="language-js">// package.json
{
  &quot;jest&quot;: {
    &quot;modulePaths&quot;: [&quot;/shared/vendor/modules&quot;],
    &quot;moduleFileExtensions&quot;: [&quot;js&quot;, &quot;jsx&quot;],
    &quot;moduleDirectories&quot;: [&quot;node_modules&quot;, &quot;bower_components&quot;, &quot;shared&quot;],
    &quot;moduleNameMapper&quot;: {
      &quot;^react(.*)$&quot;: &quot;&lt;rootDir&gt;/vendor/react-master$1&quot;,  //webpackä¸­çš„aliaså­—æ®µ
      &quot;^config$&quot;: &quot;&lt;rootDir&gt;/configs/app-config.js&quot;,  //webpackä¸­çš„aliaså­—æ®µ
      &quot;\\.(css|less)$&quot;: &quot;&lt;rootDir&gt;/__mocks__/styleMock.js&quot;, //é™æ€èµ„æº
      &quot;\\.(gif|ttf|eot|svg)$&quot;: &quot;&lt;rootDir&gt;/__mocks__/fileMock.js&quot;//é™æ€èµ„æº
    }
  }
}
</code></pre>
<p>å¯¹åº”é™æ€èµ„æºæ–‡ä»¶çš„mockæ–‡ä»¶ï¼š</p>
<pre><code class="language-js">// __mocks__/styleMock.js
module.exports = {};
</code></pre>
<pre><code class="language-js">// __mocks__/fileMock.js
module.exports = 'test-file-stub';
</code></pre>
<h2 id="è¿ç§»">è¿ç§»</h2>
<p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ AVA, Chai, Expect.js (by Automattic), Jasmine, Mocha, proxyquire, Should.jsæˆ–è€…Tapeè¿™äº›æµ‹è¯•å·¥å…·ï¼Œæƒ³è¦è¿ç§»åˆ°Jestä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦å®‰è£…<a href="https://github.com/skovhus/jest-codemods" rel="nofollow" target="_blank"> jest-codemods </a>å³å¯ã€‚</p>
<pre><code class="language-js">npm install -g jest-codemods
</code></pre>
<p>ç„¶ååœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œï¼š</p>
<pre><code class="language-js">jest-codemods
</code></pre>
<h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://www.cnblogs.com/Wolfmanlq/p/8012847.html" target="_blank" rel="nofollow">å‰ç«¯æµ‹è¯•æ¡†æ¶Jestç³»åˆ—æ•™ç¨‹</a></li>
<li><a href="https://facebook.github.io/jest/docs/en/getting-started.html" target="_blank" rel="nofollow">Jestå®˜æ–¹ç½‘ç«™</a></li>
</ul>
 </p>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12 animate-box">
                        
                            <div class="next-post">
                                <div class="next">ä¸‹ä¸€ç¯‡</div>
                                <a href="https://huxinmin.github.io/post/shi-yong-editorconfig-tong-yi-ge-chong-bian-ji-qi-dai-ma-feng-ge/">
                                    <h3 class="post-title">
                                        ä½¿ç”¨Editorconfigç»Ÿä¸€å„ç§ç¼–è¾‘å™¨ä»£ç é£æ ¼
                                    </h3>
                                </a>
                            </div>
                        
                    </div>
                </div>

                <div class="row">
    <div class="col-md-12 animate-box">
        
    </div>
</div>

            </div>

        </article>
    </div>
</div>

    

    <!-- è¿”å›é¡¶éƒ¨ -->
    <div class="back-to-top">
    
        <a href="#!" id="tool-toc" class="hidden-xs hidden-sm">
            <i class="fa fa-map"></i>
        </a>
        <br>
    
    <a href="#top" class="hidden-xs hidden-sm"><i class="fa fa-paper-plane"></i></a>
</div>

<div class="post-toc animated fadeInRight hidden-xs hidden-sm" style="display: none;">
    <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E5%89%8D%E8%A8%80">å‰è¨€</a></li>
<li><a href="#jest%E7%AE%80%E4%BB%8B">Jestç®€ä»‹</a></li>
<li><a href="#why-jest">Why Jest</a></li>
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#jest%E9%85%8D%E7%BD%AE">Jesté…ç½®</a></li>
<li><a href="#jest-cli">Jest CLI</a></li>
<li><a href="#matchers">Matchers</a></li>
<li><a href="#%E6%B5%8B%E8%AF%95%E5%BC%82%E6%AD%A5%E4%BB%A3%E7%A0%81">æµ‹è¯•å¼‚æ­¥ä»£ç </a></li>
<li><a href="#%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0">é’©å­å‡½æ•°</a></li>
<li><a href="#mock-functions">Mock Functions</a></li>
<li><a href="#jest%E5%B9%B3%E5%8F%B0">Jestå¹³å°</a></li>
<li><a href="#es6-class-mocks">Es6 Class Mocks</a><br>
*
<ul>
<li><a href="#%E8%87%AA%E5%8A%A8mock">è‡ªåŠ¨mock</a></li>
<li><a href="#%E6%89%8B%E5%8A%A8mock">æ‰‹åŠ¨mock</a></li>
<li><a href="#%E8%B0%83%E7%94%A8jestmock%E5%B9%B6%E4%BC%A0%E9%80%92%E4%B8%80%E4%B8%AA%E5%B7%A5%E5%8E%82%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0">è°ƒç”¨<code>jest.mock()</code>å¹¶ä¼ é€’ä¸€ä¸ªå·¥å‚å‡½æ•°å‚æ•°</a></li>
</ul>
</li>
<li><a href="#%E6%95%B4%E5%90%88webpack">æ•´åˆWebpack</a></li>
<li><a href="#%E8%BF%81%E7%A7%BB">è¿ç§»</a></li>
<li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">å‚è€ƒèµ„æ–™</a></li>
</ul>
</li>
</ul>

</div>


    
<footer id="fh5co-footer">
  <p>Powered by <a href="https://huxinmin.github.io" target="_blank">èƒ¡æ–°æ•çš„ä¸ªäººåšå®¢</a></p>
</footer>


    <!-- jQuery -->
<script src="https://huxinmin.github.io/media/scripts/jquery.min.js"></script>
<!-- img lazy load -->
<script src="https://huxinmin.github.io/media/scripts/jquery.lazyload.min.js"></script>
<!-- jQuery Easing -->
<script src="https://huxinmin.github.io/media/scripts/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="https://huxinmin.github.io/media/scripts/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="https://huxinmin.github.io/media/scripts/jquery.waypoints.min.js"></script>
<!-- Main JS -->
<script src="https://huxinmin.github.io/media/scripts/main.js"></script>
<!-- Md5 Min JS -->
<script src="https://huxinmin.github.io/media/scripts/md5.min.js"></script>
<!-- katex -->
<!--<script src="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.js"></script>-->
<!-- highlight -->
<script src="https://cdn.bootcss.com/highlight.js/9.15.8/highlight.min.js"></script>


<script type="application/javascript">
    // ä»£ç é«˜äº®
    hljs.initHighlightingOnLoad();

    // img æ‡’åŠ è½½
    $(function () {
        $("img.lazy").lazyload({
            effect: "fadeIn",  // æ‡’åŠ è½½åŠ¨ç”»
            threshold: 180  // åœ¨å›¾ç‰‡è·ç¦»å±å¹•180pxæ—¶æå‰è½½å…¥
        });
        // tooltip
        $('[data-toggle="tooltip"]').tooltip();

        // ç›®å½•
        $('#tool-toc').click(function () {
            $('.post-toc').toggle();
        });
    });

    
        var allImg = $("img");
        allImg.on("contextmenu", function () {
            return false;
        });
        allImg.on("dragstart", function () {
            return false;
        });
    
</script>




</body>
</html>
